# 이메일 레포트 기능 빠른 시작 가이드

## 🚀 빠른 시작

### 1단계: Gmail 앱 비밀번호 설정

1. [Google 계정 관리](https://myaccount.google.com) 접속
2. **보안** → **2단계 인증** 활성화
3. **보안** → **앱 비밀번호** 생성
4. 앱 선택: "메일"
5. 기기 선택: "기타" (예: "상담보고서")
6. 생성된 16자리 비밀번호 복사 📋

### 2단계: 웹 서버 실행

```bash
# 의존성 설치 (최초 1회)
pip install -r requirements.txt

# 웹 서버 시작
python app.py

# 브라우저에서 접속
# http://localhost:5000
```

### 3단계: 이메일 처리 요청

1. Gmail 이메일 주소 입력
2. 앱 비밀번호 입력 (16자리)
3. 처리할 기간 선택
4. **[이메일 처리 시작]** 버튼 클릭

### 4단계: 결과 확인

1. **즉시 받음** ✉️ 시작 알림 이메일
   ```
   제목: 이메일 상담 보고서 처리 시작
   
   처리 정보:
   • 기간: 2025-01-01 ~ 2025-01-31
   • 대상 이메일 수: 50건
   • 예상 완료 시간: 약 1분 40초
   ```

2. **브라우저 닫아도 OK** 👍
   - 서버에서 백그라운드로 처리 계속
   - 진행 상황은 웹에서 실시간 확인 가능 (선택사항)

3. **완료 후 받음** ✉️ 결과 이메일
   ```
   제목: 이메일 상담 보고서 처리 완료
   
   총 15건의 상담 기록이 처리되었습니다.
   
   [결과 요약 테이블]
   
   첨부파일: consultation_report_20250106_143022.xlsx
   ```

## ⏱️ 예상 처리 시간

| 이메일 수 | 예상 시간 |
|----------|----------|
| 10개     | 20초     |
| 50개     | 1분 40초 |
| 100개    | 3분 20초 |
| 200개    | 6분 40초 |

## 📧 받게 되는 이메일

### 시작 알림 이메일
- **언제**: 처리 시작 즉시
- **내용**: 
  - 처리 기간
  - 대상 이메일 수
  - 예상 완료 시간

### 완료 알림 이메일
- **언제**: 모든 처리 완료 후
- **내용**:
  - 처리된 상담 기록 수
  - 결과 요약 테이블 (HTML)
- **첨부**: Excel 파일 (.xlsx)

## ❓ 자주 묻는 질문

### Q1: 브라우저를 닫으면 어떻게 되나요?
**A:** 괜찮습니다! 서버에서 백그라운드로 처리를 계속하고, 완료되면 이메일로 결과를 보내드립니다.

### Q2: 이메일이 안 오면 어떻게 하나요?
**A:** 
1. 스팸 메일함 확인
2. Gmail 앱 비밀번호 재확인
3. 서버 로그 확인 (`python app.py` 실행 창)

### Q3: 결과 이메일은 누구에게 발송되나요?
**A:** 입력한 Gmail 계정(gmail_userid)으로 발송됩니다.

### Q4: Excel 파일은 서버에 남나요?
**A:** 아니요. 이메일 발송 후 자동으로 삭제됩니다.

### Q5: 여러 번 요청해도 되나요?
**A:** 네, 가능합니다. 각 요청은 독립적으로 처리됩니다.

## 🔒 보안 주의사항

✅ **해야 할 것:**
- Gmail 앱 비밀번호 사용 (일반 비밀번호 X)
- 2단계 인증 활성화
- HTTPS 사용 (프로덕션 환경)

❌ **하지 말아야 할 것:**
- 일반 Gmail 비밀번호 사용
- 앱 비밀번호를 코드에 하드코딩
- 공개 네트워크에서 비밀번호 입력

## 🆘 문제 해결

### 인증 실패
```
❌ Gmail 인증에 실패했습니다
```
**해결:**
1. [앱 비밀번호](https://myaccount.google.com/apppasswords) 재생성
2. 2단계 인증 활성화 확인
3. IMAP 활성화 확인 ([Gmail 설정](https://mail.google.com/mail/u/0/#settings/fwdandpop))

### 이메일 없음
```
❌ No emails found in the specified date range
```
**해결:**
1. 날짜 범위 확인 및 조정
2. 키워드 설정 확인 (기본값: "교수님", "안녕하세요", "입니다")
3. 학번 길이 설정 확인 (기본값: 8)

### 연결 실패
```
❌ Gmail 연결에 실패했습니다
```
**해결:**
1. 인터넷 연결 확인
2. 방화벽에서 포트 465, 993 허용
3. Gmail 서비스 상태 확인

## 📚 더 알아보기

- [EMAIL_REPORT_IMPLEMENTATION.md](EMAIL_REPORT_IMPLEMENTATION.md) - 기술 상세 문서
- [EMAIL_WORKFLOW_DIAGRAM.md](EMAIL_WORKFLOW_DIAGRAM.md) - 처리 흐름도
- [CHANGES_SUMMARY.md](CHANGES_SUMMARY.md) - 변경사항 요약
- [README.md](README.md) - 전체 프로젝트 문서

## 💡 팁

1. **첫 실행 전**: 작은 날짜 범위(예: 최근 7일)로 테스트
2. **빠른 처리**: 불필요한 키워드 필터 제거
3. **대량 처리**: 서버 리소스 모니터링 권장
4. **백업**: 중요한 이메일은 Gmail에서 별도 백업

## 📞 지원

문제가 계속되면:
1. 서버 로그 확인
2. GitHub Issues에 문의
3. 문서 재확인

---

**참고**: 이 기능은 Gmail SMTP를 사용하므로 [Gmail 전송 제한](https://support.google.com/mail/answer/22839)이 적용됩니다.
